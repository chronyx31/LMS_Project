<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project.lms.repository.MylectureMapper">
	<select id="isMylectureExist" resultType="mylecture">
		select * from mylecture
		<where>
			member_no = #{member_no}
			<if test='subject_no != null and subject_no != ""'>
				and subject_no = #{subject_no}
			</if>
		</where>
	</select>
	
	<insert id="ApplyLecture">
		<selectKey keyProperty="mylecture_no"  resultType="long" order="BEFORE">
			select seq_subject.nextval from dual
		</selectKey>
		insert into mylecture (
			mylecture_no,
			member_no,
			subject_no
		) values (
			#{mylecture_no},
			#{member_no},
			#{subject_no}
		)
	</insert>
	
	<select id="getAllMyLecture" resultType="membermylecture">
		select 
		sub.subject_no,
		sub.subject_title,
		sub.subject_img
		
		 from subject sub, mylecture myle
		<where>
			myle.subject_no = sub.subject_no
			and myle.member_no = #{member_no}

		</where>
	</select>
	
	
	<select id="getTotalofMyLecture" resultType="int">
		select count(*) from subject sub, mylecture myle
		<where>
			myle.subject_no = sub.subject_no
			and myle.member_no = #{member_no}
		</where>
	</select>

	<select id="getMyAttendance" resultType="attendance">
	 select * from attendance
	 	<where>
	 		member_id = #{member_id}
	 		and subject_no = #{subject_no}
	 	</where>
	</select>
	
	<select id="getAttendanceLecture_title" resultType="string">
		select lecture_title from lecture
		<where>
			lecture_no = #{lecture_no}
		</where>
	</select>
	
	<select id="getAttendanceSubject_title" resultType="string">
		select subject_title from subject
		<where>
			subject_no = #{subject_no}
		</where>
	</select>

</mapper>